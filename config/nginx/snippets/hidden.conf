# -------------------------------------------------------------------------------
#                    Block access to hidden files and directories
# -------------------------------------------------------------------------------

# Block access to any hidden files or directories (starting with a dot)
# This prevents access to sensitive files like .git, .env, .htaccess, etc.
# Excludes the /.well-known/ directory, which is used for ACME challenges and similar
location ~* (?:^|/)\.(?!well-known/)
{
    deny all;       # Deny access
    return 404;     # Return a 404 Not Found response for better security
}

# Defense-in-depth: explicitly block access to known sensitive dotfiles
location ~* /\.(git|svn|hg|bzr|env|editorconfig|htaccess|htpasswd)$
{
    deny all;       # Deny access
    return 404;     # Return a 404 Not Found response
}
