# -------------------------------------------------------------------------------
#                        WordPress Plugins - Harden Access
# -------------------------------------------------------------------------------

# Apply to wp-content/plugins directory

location ^~ /wp-content/plugins/
{
    # Block non-PHP, potentially dangerous or leftover development files
    location ~* \.(?:bak|inc|sh|sql|log|md|po|pot|mo|txt|swp|dist|conf|config)$
    {
        deny all;
        return 403;
    }

    # Block scripts like .cgi, .py, .asp, .jsp, etc.
    location ~* \.(?:cgi|pl|py|asp|aspx|jsp|war|jar|rb|exe)$
    {
        deny all;
        return 403;
    }

    # Allow normal plugin PHP files
    access_log off;
    log_not_found off;
}
