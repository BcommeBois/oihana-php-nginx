# -------------------------------------------------------------------------------
#                          WordPress Security - Hardening
# -------------------------------------------------------------------------------

# Block direct access to wp-config.php (critical credentials)
location = /wp-config.php
{
    deny all;
    return 404;
}

# Block sensitive root files (redundant readme/license/install/config/phpinfo)
location ~* ^/(?:readme\.html|license\.txt|install\.php|wp-config\.php|phpinfo\.php)$
{
    deny all;
    return 404;
}

# Block access to XML-RPC (often abused by bots)
location = /xmlrpc.php
{
    deny all;
    return 404;
}

# Prevent PHP execution in upload directories
location ~* /(?:uploads|files)/.*\.php$
{
    deny all;
}

# Block access to potentially sensitive file types in wp-content
location ~* ^/wp-content/.*\.(?:txt|md|sh|bak|inc|php|pot|po|mo|log|sql)$
{
    deny all;
}

# Block direct PHP execution in wp-includes except essential TinyMCE
location ~* ^/wp-includes/.*(?<!js/tinymce/wp-tinymce)\.php$
{
    internal;
}

# Block miscellaneous sensitive extensions anywhere
location ~* \.(?:bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)$
{
    deny all;
}
