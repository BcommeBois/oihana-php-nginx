# -------------------------------------------------------------------------------
#                        WordPress Themes - Harden Access
# -------------------------------------------------------------------------------

# Apply to wp-content/themes directory
location ^~ /wp-content/themes/
{
    # Block dangerous non-PHP or development files
    location ~* \.(?:bak|inc|sh|sql|log|md|po|pot|mo|txt|swp|dist|conf|config)$
    {
        deny all;
        return 403;
    }

    # Block execution of non-PHP scripts
    location ~* \.(?:cgi|pl|py|asp|aspx|jsp|war|jar|rb|exe)$
    {
        deny all;
        return 403;
    }

    # Allow normal theme files
    access_log off;
    log_not_found off;
}
