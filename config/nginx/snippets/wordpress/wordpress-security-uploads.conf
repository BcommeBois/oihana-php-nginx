# -------------------------------------------------------------------------------
#                      WordPress Uploads - Read-Only & Safe
# -------------------------------------------------------------------------------

# Apply only to wp-content/uploads directory
location ^~ /wp-content/uploads/
{
    # Disable execution of PHP files inside uploads
    location ~* \.php$
    {
        deny all;
        return 403;
    }

    # Block potentially dangerous files from being served
    location ~* \.(?:sh|exe|php|pl|cgi|py|asp|aspx|jsp|war|jar|rb)$
    {
        deny all;
        return 403;
    }

    # Block upload of .htaccess or config files (if PUT is allowed anywhere)
    location ~* \.(?:htaccess|htpasswd|ini|log|conf|config|bak)$
    {
        deny all;
        return 403;
    }

    # Serve static files normally
    access_log off;
    log_not_found off;
}
